<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>성공 화면</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    font-family: sans-serif;
    background: #ffcc00;
  }
  header {
    background: #f00;
    color: #fff;
    padding: 20px 16px; /* 상단 패딩 늘림 */
    font-size: 22px;
    font-weight: 700;
    display: flex;
    flex-direction: column; /* 세로 정렬로 버튼이 아래로 내려가게 */
    align-items: center;
    gap: 16px; /* 제목과 버튼 사이 간격 */
  }
  .btn-group {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
  }
  button {
    background: #fff;
    border: none;
    padding: 10px 18px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 700;
  }
  button:hover {
    background: #f4f4f4;
  }
</style>
</head>
<body>
  <header>
    <span>로그인 성공</span>
    <div class="btn-group">
      <button onclick="location.href='write.html'">소설 쓰기</button>
      <button onclick="location.href='view.html'">내 소설 보기</button>
      <button id="logoutBtn">로그아웃</button>
      <button id="deleteBtn">회원 탈퇴</button>
      <button id="adminBtn" style="display:none;">회원 목록</button> <!-- 기본 숨김 -->
    </div>
  </header>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getAuth, signOut, deleteUser, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCr516GzQlQu6ev5K9GKwlE--6GWjPSjKw",
      authDomain: "novel-app-33aa7.firebaseapp.com",
      projectId: "novel-app-33aa7",
      storageBucket: "novel-app-33aa7.firebasestorage.app",
      messagingSenderId: "791233454587",
      appId: "1:791233454587:web:20319c91ca14d34bdc6b5e",
      measurementId: "G-BXT8Y97XW2"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // 로그아웃
    document.getElementById('logoutBtn').onclick = async () => {
      await signOut(auth);
      location.href = 'index.html';
    };

    // 회원탈퇴
    document.getElementById('deleteBtn').onclick = async () => {
      if(confirm("정말 회원을 탈퇴하시겠습니까?")) {
        try {
          await deleteUser(auth.currentUser);
          alert("회원 탈퇴가 완료되었습니다.");
          location.href = 'index.html';
        } catch (e) {
          alert("회원 탈퇴 실패: " + e.message);
        }
      }
    };

    // 관리자만 회원 목록 버튼 보이기
    const urlParams = new URLSearchParams(location.search);
    if (urlParams.get('admin') === 'tls123') {
      document.getElementById('adminBtn').style.display = 'inline-block';
      document.getElementById('adminBtn').onclick = () => location.href = 'tls123.html';
    }

    // 로그인 체크
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        alert("로그인이 필요합니다.");
        location.href = "login.html";
      }
    });
  </script>
</body>
</html>
